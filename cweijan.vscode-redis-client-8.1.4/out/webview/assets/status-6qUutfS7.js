import{a as M,r as k,X as A,f as c,g as e,F as B,B as D,o as l,t as E,C as F,N as j,v as n,K as P,j as p,J as b,h as d,I as x,k as L,G as q,e as T,n as y,a7 as g,a9 as w}from"./app-quOHq0P1.js";import{L as H,a as I,b as N}from"./lineChartData-DoufKSSG.js";import{A as z}from"./arrayUtil-CzswX_vs.js";import{E as K,a as O}from"./index-GYzELZbe.js";import"./objectUtil-Z6JRxuBJ.js";import"./viewUtil-DCbZMcCo.js";import"./constants-DgoLmzql.js";import"./index-NkzjzO9b.js";import"./_baseIteratee-BzHBCr60.js";import"./isEqual-DTuzvI-Z.js";import"./merge-BVWjjS0z.js";import"./_initCloneObject-h1GxFYH3.js";import"./isArrayLikeObject-CBzOw1k1.js";import"./index-BsvDUm3z.js";const U={class:"pl-4"},X={class:"flex flex-col gap-y-1"},G={class:"var-name"},J={class:"select-all"},W=M({__name:"MySQLBasic",props:{variableList:{}},setup(C){const s=C,t=k({}),_=[{name:"Port",value:"report_port"},{name:"Version",value:"version"},{name:"Slow Query Log",value:"slow_query_log"},{name:"Performance Schema",value:"performance_schema"},{name:"Base Directory",value:"basedir"},{name:"Data Directory",value:"datadir"}];A(()=>{t.value=z.arrayToObj(s.variableList.rows,a=>a.Variable_name,"Value")});const f=a=>t.value[a];return(a,u)=>(l(),c("div",U,[u[0]||(u[0]=e("div",{class:"mb-2"}," Server Infos: ",-1)),e("div",X,[(l(),c(B,null,D(_,m=>e("div",{key:m.name,class:"flex gap-x-2 flex-wrap shrink-0"},[e("div",G,E(m.name)+":",1),e("div",J,E(f(m.value)),1)])),64))])]))}}),R=F(W,[["__scopeId","data-v-f9336731"]]),Y={class:"pl-2 my-1"},Z={class:"text-center"},tt=M({__name:"Process",setup(C){const s=k(0),t=k({fields:[],rows:[],supportKill:!1});function _(a){return a.match(/SQL|INFO|SQL_TEXT/i)?null:a==="Host"?150:100}function f(a){n.emit("killProcess",a)}return j(()=>{n.on("processList",u=>{t.value=u}),n.emit("processList");const a=()=>{s.value=window.innerHeight-110};a(),window.addEventListener("resize",a)}),(a,u)=>{const m=P("vsc-button"),S=P("vsc-tooltip"),r=K,h=O;return l(),c("div",null,[e("div",Y,[p(S,{title:a.$t("common.refresh")},{default:b(()=>[p(m,{type:"icon",icon:"codicon-refresh text-base",onClick:u[0]||(u[0]=i=>d(n).emit("processList"))})]),_:1},8,["title"])]),p(h,{data:t.value.rows,height:s.value,border:""},{default:b(()=>[(l(!0),c(B,null,D(t.value.fields,(i,o)=>(l(),x(r,{key:o,prop:i.name,label:i.name,align:"center",width:_(i.name)},null,8,["prop","label","width"]))),128)),t.value.supportKill?(l(),x(r,{key:0,label:"Action",align:"center",width:"70"},{default:b(({row:i})=>[e("div",Z,[p(m,{type:"icon",icon:"codicon-debug-stop",class:"red",title:"Kill",onClick:o=>f(i)},null,8,["onClick"])])]),_:1})):L("",!0)]),_:1},8,["data","height"])])}}}),et={class:"status-container"},st={class:"tab"},at={class:"flex flex-row",style:{height:"45vh","margin-top":"10px"}},it={class:"basis-1/3"},ot={class:"basis-2/3"},lt={style:{height:"300px"}},nt={class:"flex"},rt={class:"basis-full"},ct={style:{height:"300px"}},Bt=M({__name:"status",setup(C){const s=k("processList"),t=q({info:{dbType:null},process:{fields:[],rows:[]},variableList:{fields:[],rows:[]},statusList:{fields:[],rows:[]}}),_=new H,f=new H;function a(){r.dashBoard&&n.emit("dashBoard")}function u(){return window.innerHeight-80}const m=_.toChartData(),S=f.toChartData(),r=q({processList:!0,dashBoard:T(()=>["MariaDB","MySQL"].includes(t.info.dbType)),variableList:T(()=>["MariaDB","MySQL","PostgreSQL"].includes(t.info.dbType)),statusList:T(()=>["MariaDB","MySQL","PostgreSQL"].includes(t.info.dbType))});function h(){a(),n.emit("processList"),r.variableList&&n.emit("variableList"),r.statusList&&n.emit("statusList")}return n.on("info",i=>{t.info=i,r[s.value]||(s.value="processList"),h()}).on("variableList",i=>{t.variableList=i}).on("statusList",i=>{t.statusList=i}).on("dashBoard",i=>{f.addData(i.traffic),_.addData(i.queries)}).init("status"),window.addEventListener("focus",()=>{n.init("status")}),h(),setTimeout(()=>a(),1e3),setInterval(()=>a(),3e3),(i,o)=>{const Q=K,V=O;return l(),c("div",et,[e("ul",st,[r.dashBoard?(l(),c("li",{key:0,class:y(["tab__item",{"tab__item--active":s.value=="dashBoard"}]),onClick:o[0]||(o[0]=v=>{s.value="dashBoard",a()})}," Dashboard ",2)):L("",!0),r.processList?(l(),c("li",{key:1,class:y(["tab__item",{"tab__item--active":s.value=="processList"}]),onClick:o[1]||(o[1]=v=>{s.value="processList",d(n).emit("processList")})}," ProcessList ",2)):L("",!0),r.variableList?(l(),c("li",{key:2,class:y(["tab__item",{"tab__item--active":s.value=="variableList"}]),onClick:o[2]||(o[2]=v=>{s.value="variableList",d(n).emit("variableList")})}," VariableList ",2)):L("",!0),r.statusList?(l(),c("li",{key:3,class:y(["tab__item",{"tab__item--active":s.value=="statusList"}]),onClick:o[3]||(o[3]=v=>{s.value="statusList",d(n).emit("statusList")})}," StatusList ",2)):L("",!0)]),g(e("div",null,[e("div",at,[e("div",it,[p(R,{variableList:t.variableList},null,8,["variableList"])]),e("div",ot,[o[4]||(o[4]=e("span",{class:"select-none"},"Traffic:",-1)),e("div",lt,[p(d(N),{options:d(I).getOption(!0),data:d(S)},null,8,["options","data"])])])]),e("div",nt,[e("div",rt,[o[5]||(o[5]=e("span",{class:"select-none"},"Queries:",-1)),e("div",ct,[p(d(N),{options:d(I).getOption(),data:d(m)},null,8,["options","data"])])])])],512),[[w,["MariaDB","MySQL"].includes(t.info.dbType)&&s.value=="dashBoard"]]),g(p(tt,null,null,512),[[w,s.value=="processList"]]),g(e("div",null,[p(V,{data:t.variableList.rows,"cell-style":{height:"35px"},style:{width:"100%"},height:u()},{default:b(()=>[(l(!0),c(B,null,D(t.variableList.fields,(v,$)=>(l(),x(Q,{key:$,prop:v.name,label:v.name,align:"center"},null,8,["prop","label"]))),128))]),_:1},8,["data","height"])],512),[[w,t.info.dbType!="SqlServer"&&s.value=="variableList"]]),g(e("div",null,[p(V,{data:t.statusList.rows,"cell-style":{height:"35px"},style:{width:"100%"},height:u()},{default:b(()=>[(l(!0),c(B,null,D(t.statusList.fields,(v,$)=>(l(),x(Q,{key:$,prop:v.name,label:v.name,align:"center"},null,8,["prop","label"]))),128))]),_:1},8,["data","height"])],512),[[w,t.info.dbType!="SqlServer"&&s.value=="statusList"]])])}}});export{Bt as default};
